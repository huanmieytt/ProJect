package com.example.demo.ytt;




import java.util.ArrayList;
import java.util.List;

public class Test {
    public static void main(String[] args) {
        String str = " WITH INCZHZD AS   (SELECT C_T_CODE, C_S_CODE      FROM T_V_D_GROUP_DETAIL B      JOIN (SELECT C_GROUP_CODE_P, C_GROUP_CODE             FROM T_V_D_GROUP A            START WITH A.C_GROUP_CODE_P = '[root]'                   AND A.C_GROUP_CODE = 'ZHBZINC'           CONNECT BY PRIOR A.C_GROUP_CODE = A.C_GROUP_CODE_P) C        ON B.C_GROUP_CODE = C.C_GROUP_CODE),    TISZHZD AS   (SELECT C_T_CODE, C_S_CODE      FROM T_V_D_GROUP_DETAIL B      JOIN (SELECT C_GROUP_CODE_P, C_GROUP_CODE             FROM T_V_D_GROUP A            START WITH A.C_GROUP_CODE_P = '[root]'                   AND A.C_GROUP_CODE = 'ZHDMTISM'           CONNECT BY PRIOR A.C_GROUP_CODE = A.C_GROUP_CODE_P) C        ON B.C_GROUP_CODE = C.C_GROUP_CODE)    SELECT T.ZMDM || '|' AS ZMDM,         T.ZQID || '|' AS ZQID,         T.TZFX || '|' AS TZFX,         T.BWBSZ || '|' AS BWBSZ,         TO_CHAR(T.RQ, 'yyyyMMdd') || '|' AS RQ,         T.LXYB || '|' AS LXYB,         T.LXBWB || '|' AS LXBWB,         T.SL || '|' AS SL,         T.TISMA || '|' AS TISMA,         T.BWBCB || '|' AS BWBCB,         T.DWCB || '|' AS DWCB,         '' || '|' AS UN1,         '' || '|' AS UN2,         '' || '|' AS UN3,         '' || '|' AS UN4,         '' || '|' AS UN5,         '' || '|' AS UN6,         '' || '|' AS UN7    FROM (SELECT *            FROM (SELECT *                    FROM (SELECT *                            FROM (SELECT 1 AS SX,                                         ZQ.ZMDM AS ZMDM,                                         ZQ.ZQID AS ZQID,                                         ZQ.TZFX AS TZFX,                                         ZQ.BWBSZ AS BWBSZ,                                         ZQ.RQ AS RQ,                                         ZQ.LXYB AS LXYB,                                         ZQ.LXBWB AS LXBWB,                                         ZQ.SL AS SL,                                         ZQ.TISMA AS TISMA,                                         ZQ.BWBCB AS BWBCB,                                         ZQ.DWCB AS DWCB                                    FROM (SELECT *                                    FROM (SELECT TO_CHAR(SUM(BWBSZ), 'fm9999999999999999999990.00') AS BWBSZ,                                        \t\t\tTO_CHAR(SUM(LXYB), 'fm99999999999990.0000000000') AS LXYB,                                        \t\t\tTO_CHAR(SUM(LXBWB), 'fm9999999999999999999990.00') AS LXBWB,                                        \t\t\tTO_CHAR(SUM(BWBCB), 'fm9999999999999999999990.00') AS BWBCB,                                        \t\t\tTO_CHAR( DECODE((SUM(BWBCB)/DECODE(SUM(AMOUNT),0,1,SUM(AMOUNT))),SUM(BWBCB),1,(SUM(BWBCB)/DECODE(SUM(AMOUNT),0,1,SUM(AMOUNT)))),'fm999999999990.000000000000')AS DWCB,                                        \t\t\tZMDM,RQ,SUM(SL) AS SL,TISMA,ZQID,TZFX                                           FROM (SELECT A.C_PORT_CODE AS ZMDM,                                                            NVL(SEC.C_SM_CODE,                                                                A.C_SEC_CODE)                                                         \t AS ZQID,                                                          CASE WHEN SEC.C_SEC_VAR_CODE LIKE                                                                'HG%' THEN                                                          \t\t A.N_PORT_MV                                                            \t\t\tELSE                                                          \t\t  A.N_PORT_MV * N_WAY END                                                               \tAS BWBSZ,                                                         A.D_ASTSTAT AS RQ,                                                             NVL(B.N_ORIG_MV, 0) AS   LXYB ,                                                             NVL(B.N_PORT_MV, 0) AS   LXBWB ,                                                         CASE                                                           WHEN SEC.C_SEC_VAR_CODE LIKE                                                                'HG%' THEN                                                            A.N_PORT_COST                                                           WHEN SEC.C_SEC_VAR_CODE LIKE                                                                'ZQ%' THEN                                                            A.N_AMOUNT * SEC.N_FV_ISSUE                                                           ELSE                                                            A.N_AMOUNT                                                         END AS SL,                                                          CASE WHEN (CASE                                                           WHEN SEC.C_SEC_VAR_CODE LIKE                                                                'HG%' THEN                                                            A.N_PORT_COST                                                           WHEN SEC.C_SEC_VAR_CODE LIKE                                                                'ZQ%' THEN                                                            A.N_AMOUNT * SEC.N_FV_ISSUE                                                           ELSE                                                            A.N_AMOUNT                                                         END) > 0 THEN 'L' ELSE 'S' END AS TZFX,                                                            NVL(SEC.C_SM_CODE,                                                                A.C_SEC_CODE)                                                         \t AS TISMA,                                                           CASE WHEN SEC.C_SEC_VAR_CODE LIKE                                                                'HG%' THEN                                                            \tA.N_PORT_COST                                                           \t\t ELSE                                                            A.N_PORT_COST *                                                                   A.N_WAY                                                          \tEND AS BWBCB,                                                         CASE                                                                   WHEN SEC.C_SEC_VAR_CODE LIKE                                                                        'ZQ%' THEN                                                                    A.N_PORT_COST * A.N_WAY /                                                                    DECODE(A.N_AMOUNT,                                                                           0,                                                                           1,                                                                           A.N_AMOUNT)                                                                   WHEN SEC.C_SEC_VAR_CODE LIKE                                                                        'HG%' THEN                                                                    1                                                                   ELSE                                                                    A.N_PORT_COST * A.N_WAY /                                                                    DECODE(A.N_AMOUNT,                                                                           0,                                                                           1,                                                                           A.N_AMOUNT)                                                                 END                                                               AS DWCB,                                                             \t SEC.C_SEC_VAR_CODE AS SEC_VAR_CODE ,                                                              \tDECODE(A.N_AMOUNT,                                                                         0,                                                                         0,                                                                 A.N_AMOUNT)  AS AMOUNT                                                   FROM T_R_FR_ASTSTAT A                                                    LEFT JOIN T_P_SV_SEC_BASE SEC ON A.C_SEC_CODE = SEC.C_SEC_CODE                                                    LEFT JOIN (SELECT *                                                                FROM T_V_D_GROUP_DETAIL B                                                                JOIN (SELECT C_GROUP_CODE_P, C_GROUP_CODE                                                                       FROM T_V_D_GROUP A                                                                      START WITH A.C_GROUP_CODE_P = '[root]'                                                                             AND A.C_GROUP_CODE = 'XSGZQDMSMM'                                                                             AND A.N_CHECK_STATE = 1                                                                     CONNECT BY PRIOR                                                                                 A.C_GROUP_CODE = A.C_GROUP_CODE_P) C                                                                  ON B.C_GROUP_CODE = C.C_GROUP_CODE                                                                 AND B.N_CHECK_STATE = 1) SMZH                                                      ON SMZH.C_S_CODE = SEC.C_SEC_CODE                                                    LEFT JOIN (SELECT C_PORT_CODE,                                                                     C_SEC_CODE,                                                                     C_DTA_CODE,                                                                     C_DV_ISSUE_MODE,                                                                     C_DV_INVEST_CLS,                                                                     CASE                                                                       WHEN C_SEC_VAR_CODE LIKE 'HG%' THEN                                                                        N_ORIG_MV                                                                       ELSE                                                                        N_ORIG_MV * N_WAY                                                                     END AS N_ORIG_MV,                                                                     CASE                                                                       WHEN C_SEC_VAR_CODE LIKE 'HG%' THEN                                                                        N_PORT_MV                                                                       ELSE                                                                        N_PORT_MV * N_WAY                                                                     END AS N_PORT_MV,                                                                     C_DAI_CODE                                                                FROM T_R_FR_ASTSTAT                                                               WHERE C_PORT_CODE IN (SELECT * FROM TABLE(?))                                                                 AND D_ASTSTAT = ?                                                                 AND C_DAI_CODE IN ('YSLX_ZQ', 'YFLX_ZQ', 'YSK_GL')                                                                 AND TRIM(C_SEC_CODE) IS NOT NULL) B                                                      ON A.C_PORT_CODE = B.C_PORT_CODE                                                     AND A.C_SEC_CODE = B.C_SEC_CODE                                                     AND A.C_DTA_CODE = B.C_DTA_CODE                                                     AND A.C_DV_ISSUE_MODE = B.C_DV_ISSUE_MODE                                                     AND A.C_DV_INVEST_CLS = B.C_DV_INVEST_CLS                                                   WHERE A.C_PORT_CODE IN (SELECT * FROM TABLE(?))                                                     AND A.D_ASTSTAT = ?                                                     AND A.C_DAI_CODE IN ('ZQTZ_CB', 'MRFSJRZC', 'MCHGJRZC', 'YSGJ_CB')                                                     AND CASE                                                           WHEN (A.C_DAI_CODE = 'MCHGJRZC' AND B.C_DAI_CODE = 'YSLX_ZQ')                                                                 OR                                                                (A.C_DAI_CODE = 'MRFSJRZC' AND B.C_DAI_CODE = 'YFLX_ZQ') THEN                                                            0                                                           ELSE                                                            1                                                         END = 1)                                                        group by  ZMDM,ZQID,RQ,TISMA,TZFX,SEC_VAR_CODE                                                  UNION ALL                                    \t\t\t\t\t SELECT TO_CHAR(SUM(BWBSZ),'fm9999999999999999999990.00') AS BWBSZ,                                        \t\t\tTO_CHAR(SUM(LXYB), 'fm99999999999990.0000000000') AS LXYB,                                        \t\t\tTO_CHAR(SUM(LXBWB), 'fm9999999999999999999990.00') AS LXBWB,                                        \t\t\tTO_CHAR(SUM(BWBCB), 'fm9999999999999999999990.00') AS BWBCB,                                        \t\t\tTO_CHAR( DECODE((SUM(BWBCB)/DECODE(SUM(AMOUNT),0,1,SUM(AMOUNT))),SUM(BWBCB),1,(SUM(BWBCB)/DECODE(SUM(AMOUNT),0,1,SUM(AMOUNT)))),'fm999999999990.000000000000')AS DWCB,                                        \t\t\tZMDM,RQ,SUM(SL) AS SL,TISMA,ZQID,TZFX                                                 FROM (SELECT A.C_PORT_CODE AS ZMDM,                                                            NVL(SEC.C_SM_CODE, A.C_SEC_CODE)                                                         \tAS ZQID,                                                         CASE                                                           WHEN SEC.C_SEC_VAR_CODE LIKE 'HG%' THEN                                                          \t\t\t 0                                                           ELSE                                                          \t\t\t 0                                                         END AS BWBSZ,                                                         A.D_ASTSTAT AS RQ,                                                         NVL(A.N_ORIG_MV, 0) AS LXYB,                                                         NVL(A.N_PORT_MV, 0) AS LXBWB,                                                         CASE                                                           WHEN SEC.C_SEC_VAR_CODE LIKE 'HG%' THEN                                                            A.N_PORT_COST                                                           WHEN SEC.C_SEC_VAR_CODE LIKE 'ZQ%' THEN                                                            A.N_AMOUNT * SEC.N_FV_ISSUE                                                           ELSE                                                            A.N_AMOUNT                                                         END AS SL,                                                          CASE WHEN (CASE                                                           WHEN SEC.C_SEC_VAR_CODE LIKE 'HG%' THEN                                                            A.N_PORT_COST                                                           WHEN SEC.C_SEC_VAR_CODE LIKE 'ZQ%' THEN                                                            A.N_AMOUNT * SEC.N_FV_ISSUE                                                           ELSE                                                            A.N_AMOUNT                                                         END) > 0 THEN 'L' ELSE 'S' END AS TZFX,                                                            NVL(SEC.C_SM_CODE, A.C_SEC_CODE)                                                         \t AS TISMA,                                                         CASE                                                           WHEN SEC.C_SEC_VAR_CODE LIKE 'HG%' THEN                                                           \t\t 0                                                           ELSE                                                          \t\t 0                                                         END AS BWBCB,                                                         1 AS DWCB,                                                         SEC.C_SEC_VAR_CODE AS SEC_VAR_CODE ,                                                         DECODE(A.N_AMOUNT,                                                                         0,                                                                         0,                                                                 A.N_AMOUNT)  AS AMOUNT                                                   FROM T_R_FR_ASTSTAT A                                                    LEFT JOIN T_P_SV_SEC_BASE SEC ON A.C_SEC_CODE =  SEC.C_SEC_CODE                                                    LEFT JOIN (SELECT *                                                                FROM T_V_D_GROUP_DETAIL B                                                                JOIN (SELECT C_GROUP_CODE_P, C_GROUP_CODE                                                                       FROM T_V_D_GROUP A                                                                      START WITH A.C_GROUP_CODE_P = '[root]'                                                                             AND A.C_GROUP_CODE = 'XSGZQDMSMM'                                                                             AND A.N_CHECK_STATE = 1                                                                     CONNECT BY PRIOR                                                                                 A.C_GROUP_CODE =                                                                                 A.C_GROUP_CODE_P) C                                                                  ON B.C_GROUP_CODE =  C.C_GROUP_CODE                                                                 AND B.N_CHECK_STATE = 1) SMZH                                                      ON SMZH.C_S_CODE =  SEC.C_SEC_CODE                                                   WHERE A.C_PORT_CODE IN (SELECT * FROM TABLE(?))                                                     AND A.D_ASTSTAT = ?                                                     AND A.C_DAI_CODE IN ('YSLX_ZQ', 'YFLX_ZQ', 'YSK_GL')                                                     AND NOT EXISTS                                                   (SELECT 1                                                            FROM T_R_FR_ASTSTAT B                                                           WHERE A.C_PORT_CODE = B.C_PORT_CODE                                                             AND A.C_SEC_CODE = B.C_SEC_CODE                                                             AND A.C_DTA_CODE = B.C_DTA_CODE                                                             AND A.C_DV_ISSUE_MODE = B.C_DV_ISSUE_MODE                                                             AND A.C_DV_INVEST_CLS = B.C_DV_INVEST_CLS                                                             AND A.D_ASTSTAT = B.D_ASTSTAT                                                             AND B.C_DAI_CODE IN ('ZQTZ_CB', 'MRFSJRZC', 'MCHGJRZC', 'YSGJ_CB')))group by  ZMDM,ZQID,RQ,TISMA,TZFX,SEC_VAR_CODE                                            ORDER BY ZMDM, ZQID ))ZQ                          UNION ALL                          SELECT *                            FROM (SELECT 1 AS SX,                                         NVL(A.C_PORT_CODE, B.C_PORT_CODE) AS ZMDM,                                         NVL(A.TISMA, B.TISMA) AS ZQID,                                         'L' AS TZFX,                                         TO_CHAR(NVL(A.N_PORT_MV, 0), 'fm9999999999999999999990.00') AS BWBSZ,                                         NVL(A.D_ASTSTAT, B.D_ASTSTAT) AS RQ,                                         TO_CHAR(NVL(B.N_ORIG_MV, 0), 'fm99999999999990.0000000000') AS LXYB,                                         TO_CHAR(NVL(B.N_PORT_MV, 0), 'fm9999999999999999999990.00') AS LXBWB,                                         NVL(A.N_PORT_COST, 0) AS SL,                                         NVL(A.TISMA, B.TISMA) AS TISMA,                                         TO_CHAR(NVL(A.N_PORT_COST, 0), 'fm9999999999999999999990.00') AS BWBCB,                                         TO_CHAR(1, 'fm999999999990.000000000000') AS DWCB                                    FROM (SELECT C_PORT_CODE,                                                 TIS.C_T_CODE AS TISMA,                                                 D_ASTSTAT,                                                 SUM(NVL(N_PORT_MV * N_WAY, 0)) AS N_PORT_MV,                                                 SUM(NVL(N_PORT_COST * N_WAY, 0)) AS N_PORT_COST                                            FROM T_R_FR_ASTSTAT A                                            JOIN TISZHZD TIS ON A.C_CA_CODE = TIS.C_S_CODE                                           WHERE C_PORT_CODE IN (SELECT * FROM TABLE(?))                                             AND D_ASTSTAT = ?                                             AND C_DAI_CODE = 'HBZJ'                                             AND C_NAV_TYPE = 'CACH'                                             AND TRIM(C_CA_CODE) IS NOT NULL                                           GROUP BY C_PORT_CODE, D_ASTSTAT, C_T_CODE) A                                    FULL JOIN (SELECT C_PORT_CODE,                                                     D_ASTSTAT,                                                     TIS.C_T_CODE AS TISMA,                                                     SUM(N_ORIG_MV * N_WAY) AS N_ORIG_MV,                                                     SUM(N_PORT_MV * N_WAY) AS N_PORT_MV                                                FROM T_R_FR_ASTSTAT A                                                JOIN TISZHZD TIS ON A.C_CA_CODE = TIS.C_S_CODE                                               WHERE C_PORT_CODE IN (SELECT * FROM TABLE(?))                                                 AND D_ASTSTAT = ?                                                 AND C_DAI_CODE = 'YSLX_ZJ'                                                 AND C_NAV_TYPE = 'CACH_SEC'                                                 AND TRIM(C_CA_CODE) IS NOT NULL                                               GROUP BY C_PORT_CODE,  D_ASTSTAT, C_T_CODE) B                                      ON A.C_PORT_CODE = B.C_PORT_CODE                                     AND A.TISMA = B.TISMA                                   ORDER BY A.C_PORT_CODE, ZQID))                   ORDER BY ZMDM, ZQID, TZFX))                    UNION ALL          SELECT *            FROM (SELECT *                    FROM (SELECT *                            FROM (SELECT 2 AS SX,                                         C_PORT_CODE AS ZMDM,                                         C_DC_CODE AS ZQID,                                         'L' AS TZFX,                                         TO_CHAR(N_PORT_MV, 'fm9999999999999999999990.00') AS BWBSZ,                                         D_ASTSTAT AS RQ,                                         TO_CHAR(N_ORIG_MV_LX, 'fm99999999999990.0000000000') AS LXYB,                                         TO_CHAR(N_PORT_MV_LX, 'fm9999999999999999999990.00') AS LXBWB,                                         N_ORIG_MV AS SL,                                         C_DC_CODE AS TISMA,                                         TO_CHAR(N_PORT_COST, 'fm9999999999999999999990.00') AS BWBCB,                                         TO_CHAR(N_ORIG_MV / DECODE(N_PORT_MV, 0, 1, N_PORT_MV), 'fm999999999990.000000000000') DWCB                                    FROM (SELECT NVL(A.C_PORT_CODE, NVL(B.C_PORT_CODE,  C.C_PORT_CODE)) C_PORT_CODE,                                                 NVL(A.C_DC_CODE, NVL(B.C_DC_CODE, C.C_DC_CODE)) C_DC_CODE,                                                 NVL(A.D_ASTSTAT, NVL(B.D_ASTSTAT, C.D_ASTSTAT)) D_ASTSTAT,                                                 NVL(B.N_PORT_MV + NVL(D.N_SELL_MONEY, 0), 0) AS N_PORT_MV,                                                 NVL(B.N_ORIG_MV + NVL(D.N_ORIG_MONEY, 0), 0) AS N_ORIG_MV,                                                 NVL(B.N_PORT_COST + NVL(D.N_SELL_MONEY, 0), 0) AS N_PORT_COST,                                                 NVL(C.N_ORIG_MV, 0) AS N_ORIG_MV_LX,                                                 NVL(C.N_PORT_MV, 0) AS N_PORT_MV_LX                                            FROM (SELECT DISTINCT C_PORT_CODE,                                                                  NVL(F.C_T_CODE, A.C_DC_CODE) AS C_DC_CODE,                                                                  D_ASTSTAT                                                    FROM T_R_FR_ASTSTAT A                                                    LEFT JOIN TISZHZD TIS ON A.C_CA_CODE = TIS.C_S_CODE                                                    LEFT JOIN INCZHZD F ON A.C_CA_CODE = F.C_S_CODE                                                   WHERE C_PORT_CODE IN (SELECT * FROM TABLE(?))                                                     AND D_ASTSTAT = ?                                                     AND C_DAI_CODE = 'HBZJ'                                                     AND C_NAV_TYPE = 'CACH'                                                     AND C_DV_ACC_TYPE NOT LIKE '%EX_RES%'                                                     AND C_DV_ACC_TYPE NOT LIKE '%ACC_TD_BAIL%'                                                     AND TRIM(C_CA_CODE) IS NOT NULL                                                     AND TRIM(TIS.C_T_CODE) IS NULL                                                     AND TRIM(F.C_T_CODE) IS NULL) A                                            FULL JOIN (SELECT SUM(0 + (CASE WHEN C_DAI_CODE IN ('HBZJ', 'ZQQSK', 'ZQQSK_SQK') THEN N_PORT_MV * N_WAY                                                                   ELSE                                                                    N_PORT_MV * N_WAY * -1                                                                 END)) AS N_PORT_MV,                                                             SUM(0 + (CASE WHEN C_DAI_CODE IN ('HBZJ', 'ZQQSK', 'ZQQSK_SQK') THEN N_ORIG_MV * N_WAY                                                                   ELSE                                                                    N_ORIG_MV * N_WAY * -1                                                                 END)) AS N_ORIG_MV,                                                             SUM(0 + (CASE WHEN C_DAI_CODE IN ('HBZJ', 'ZQQSK', 'ZQQSK_SQK') THEN N_PORT_COST * N_WAY                                                                   ELSE                                                                    N_PORT_COST * N_WAY * -1                                                                 END)) AS N_PORT_COST,                                                             C_PORT_CODE,                                                             C_DC_CODE,                                                             D_ASTSTAT                                                        FROM (SELECT A.C_PORT_CODE,                                                                     A.D_ASTSTAT,                                                                     A.N_WAY,                                                                     A.C_DAI_CODE,                                                                     A.N_PORT_MV,                                                                     A.N_ORIG_MV,                                                                     A.N_PORT_COST,                                                                     NVL(F.C_T_CODE, A.C_DC_CODE) AS C_DC_CODE                                                                FROM T_R_FR_ASTSTAT A                                                                LEFT JOIN TISZHZD TIS  ON A.C_CA_CODE = TIS.C_S_CODE                                                                LEFT JOIN INCZHZD F  ON A.C_CA_CODE = F.C_S_CODE                                                               WHERE C_PORT_CODE IN (SELECT * FROM TABLE(?))                                                                 AND D_ASTSTAT = ?                                                                 AND C_DAI_CODE IN ('HBZJ', 'ZQQSK', 'ZQQSK_SQK', 'YFK_SHK', 'YFK_SHF')                                                                 AND C_DV_ACC_TYPE NOT LIKE '%EX_RES%'                                                                 AND C_DV_ACC_TYPE NOT LIKE '%ACC_TD_BAIL%'                                                                 AND TRIM(TIS.C_T_CODE) IS NULL                                                                 AND TRIM(F.C_T_CODE) IS NULL)                                                       GROUP BY C_PORT_CODE, C_DC_CODE, D_ASTSTAT) B                                              ON A.C_PORT_CODE = B.C_PORT_CODE                                             AND A.C_DC_CODE = B.C_DC_CODE                                            FULL JOIN (SELECT A.C_PORT_CODE,                                                             A.C_DC_CODE,                                                             A.D_ASTSTAT,                                                             SUM(N_ORIG_MV * N_WAY) AS N_ORIG_MV,                                                             SUM(N_PORT_MV * N_WAY) AS N_PORT_MV                                                        FROM (SELECT A.C_PORT_CODE,                                                                     A.D_ASTSTAT,                                                                     A.N_WAY,                                                                     A.C_DAI_CODE,                                                                     A.N_PORT_MV,                                                                     A.N_ORIG_MV,                                                                     A.N_PORT_COST,                                                                     NVL(F.C_T_CODE, A.C_DC_CODE) AS C_DC_CODE                                                                FROM T_R_FR_ASTSTAT A                                                                LEFT JOIN TISZHZD TIS ON A.C_CA_CODE = TIS.C_S_CODE                                                                LEFT JOIN INCZHZD F ON A.C_CA_CODE = F.C_S_CODE                                                               WHERE A.C_PORT_CODE IN (SELECT * FROM TABLE(?))                                                                 AND A.D_ASTSTAT = ?                                                                 AND A.C_DAI_CODE = 'YSLX_ZJ'                                                                 AND A.C_DV_ACC_TYPE NOT LIKE '%EX_RES%'                                                                 AND A.C_DV_ACC_TYPE NOT LIKE '%ACC_TD_BAIL%'                                                                 AND TRIM(TIS.C_T_CODE) IS NULL                                                                 AND TRIM(F.C_T_CODE) IS NULL) A                                                       GROUP BY C_PORT_CODE, C_DC_CODE, D_ASTSTAT) C                                              ON A.C_PORT_CODE = C.C_PORT_CODE                                             AND A.C_DC_CODE = C.C_DC_CODE                                            FULL JOIN (SELECT TA.C_PORT_CODE,                                                             TA.C_DC_CODE,                                                             SUM(ROUND(TA.N_SELL_MONEY *                                                                       NVL(TO_NUMBER(PKG_FUN_F_EXPRESS.F_EXPRESS(TA.C_RATE_EXPR)),                                                                           1),                                                                       2)) AS N_SELL_MONEY,                                                             SUM(TA.N_SELL_MONEY) AS N_ORIG_MONEY                                                        FROM (SELECT TA.C_PORT_CODE,                                                                     TA.N_SELL_MONEY,                                                                     PR.C_RATE_EXPR,                                                                     NVL(F.C_T_CODE, TA.C_DC_CODE) AS C_DC_CODE                                                                FROM T_D_AC_SELL_TA TA                                                                LEFT JOIN INCZHZD F ON TA.C_CA_CODE_SETT = F.C_S_CODE                                                                LEFT JOIN T_D_AI_VAL_PR PR ON TA.C_PORT_CODE = PR.C_PORT_CODE                                                                 AND D_VAL_ACCT = ?                                                                 AND C_PR_TYPE = 'R'                                                                 AND NVL(TA.C_DC_CODE, 'CNY') = PR.C_VAL_PR_CODE                                                                LEFT JOIN T_P_AB_PORT PORT ON TA.C_PORT_CODE = PORT.C_PORT_CODE                                                               WHERE TA.C_PORT_CODE IN (SELECT * FROM TABLE(?))                                                                 AND C_DS_CODE = 'TAXS_SG'                                                                 AND D_SETT = PKG_FUN_GETDAY_HDAY.GETDAY_HDAY(PORT.C_HDAY_CODE, ?, 1, 'W')                                                                 AND D_CONFIRM != D_SETT                                                                 AND TRIM(F.C_T_CODE) IS NULL) TA                                                       GROUP BY TA.C_PORT_CODE, TA.C_DC_CODE) D                                              ON A.C_PORT_CODE = D.C_PORT_CODE                                             AND A.C_DC_CODE = D.C_DC_CODE)                                   ORDER BY C_PORT_CODE, ZQID)                          UNION ALL                          SELECT *                            FROM (SELECT DISTINCT 2 AS SX,                                                  ZMDM,                                                  ZQID,                                                  TZFX,                                                  BWBSZ,                                                  RQ,                                                  LXYB,                                                  LXBWB,                                                  SL,                                                  TISMA,                                                  BWBCB,                                                  DWCB                                    FROM (SELECT R.C_PORT_CODE AS ZMDM,                                                 NVL(F.C_T_CODE, A.C_DC_CODE) AS ZQID,                                                 'L' AS TZFX,                                                 '0' AS BWBSZ,                                                 ? AS RQ,                                                 '0' AS LXYB,                                                 '0' AS LXBWB,                                                 0 AS SL,                                                 NVL(D.C_T_CODE, A.C_DC_CODE) AS TISMA,                                                 '0' AS BWBCB,                                                 '0' AS DWCB                                            FROM T_P_BI_CASH_ACC A                                            JOIN T_P_AB_PORT_RELA R                                              ON R.C_RELA_TYPE = 'RELA_CASH_ACC'                                             AND R.N_CHECK_STATE = 1                                             AND R.C_RELA_CODE = A.C_CA_CODE                                            LEFT JOIN TISZHZD D  ON A.C_CA_CODE = D.C_S_CODE                                            LEFT JOIN INCZHZD F ON A.C_CA_CODE = F.C_S_CODE                                           WHERE A.N_CHECK_STATE = 1                                             AND R.C_PORT_CODE IN (SELECT * FROM TABLE(?))                                             AND TRIM(F.C_T_CODE) IS NULL                                             AND C_DC_CODE NOT IN                                                 (SELECT DISTINCT C_DC_CODE                                                    FROM T_R_FR_ASTSTAT A                                                   WHERE A.C_PORT_CODE =                                                         R.C_PORT_CODE                                                     AND D_ASTSTAT = ?                                                     AND (TRIM(C_CA_CODE) IS NOT NULL OR                                                         (C_DAI_CODE IN ('HBZJ', 'ZQQSK', 'ZQQSK_SQK', 'YSK_SGK', 'YFK_SHK', 'YFK_SHF', 'YSLX_ZJ')                                                          AND C_DV_ACC_TYPE NOT LIKE '%EX_RES%'                                                          AND C_DV_ACC_TYPE NOT LIKE '%ACC_TD_BAIL%'))))                                   ORDER BY ZMDM, ZQID))                   ORDER BY ZMDM, ZQID)                    UNION ALL          SELECT SX,                 ZMDM,                 ZQID,                 TZFX,                 TO_CHAR(SUM(BWBSZ), 'fm9999999999999999999990.00') AS BWBSZ,                 RQ,                 TO_CHAR(SUM(LXYB), 'fm99999999999990.0000000000') AS LXYB,                 TO_CHAR(SUM(LXBWB), 'fm9999999999999999999990.00') AS LXBWB,                 SUM(SL),                 TISMA,                 TO_CHAR(SUM(BWBCB), 'fm9999999999999999999990.00') AS BWBCB,                 TO_CHAR(SUM(SL) / SUM(BWBCB), 'fm999999999990.000000000000') DWCB            FROM (SELECT *                    FROM (SELECT *                            FROM (SELECT *                                    FROM (SELECT 3 AS SX,                                                 C_PORT_CODE AS ZMDM,                                                 C_DC_CODE AS ZQID,                                                 'L' AS TZFX,                                                 N_PORT_MV AS BWBSZ,                                                 D_ASTSTAT AS RQ,                                                 N_ORIG_MV_LX AS LXYB,                                                 N_PORT_MV_LX AS LXBWB,                                                 N_ORIG_MV AS SL,                                                 C_DC_CODE AS TISMA,                                                 N_PORT_COST AS BWBCB,                                                 N_ORIG_MV / DECODE(N_PORT_MV, 0, 1, N_PORT_MV) DWCB                                            FROM (SELECT NVL(A.C_PORT_CODE,  NVL(B.C_PORT_CODE, C.C_PORT_CODE)) C_PORT_CODE,                                                         NVL(A.C_DC_CODE, NVL(B.C_DC_CODE,  C.C_DC_CODE)) C_DC_CODE,                                                         NVL(A.D_ASTSTAT, NVL(B.D_ASTSTAT, C.D_ASTSTAT)) D_ASTSTAT,                                                         NVL(B.N_PORT_MV + NVL(D.N_SELL_MONEY, 0), 0) AS N_PORT_MV,                                                         NVL(B.N_ORIG_MV + NVL(D.N_ORIG_MONEY, 0), 0) AS N_ORIG_MV,                                                         NVL(B.N_PORT_COST +  NVL(D.N_SELL_MONEY, 0), 0) AS N_PORT_COST,                                                         NVL(C.N_ORIG_MV, 0) AS N_ORIG_MV_LX,                                                         NVL(C.N_PORT_MV, 0) AS N_PORT_MV_LX                                                    FROM (SELECT DISTINCT C_PORT_CODE,                                                                          CASE                                                                            WHEN C_DV_ACC_TYPE LIKE                                                                                 '%EX_RES%' OR                                                                                 C_DV_ACC_TYPE LIKE                                                                                 '%ACC_TD_BAIL%' THEN                                                                             A.C_DC_CODE ||                                                                             '_INC'                                                                            ELSE                                                                             F.C_T_CODE                                                                          END AS C_DC_CODE,                                                                          D_ASTSTAT                                                            FROM T_R_FR_ASTSTAT A                                                            LEFT JOIN INCZHZD F ON A.C_CA_CODE = F.C_S_CODE                                                            LEFT JOIN TISZHZD TIS ON A.C_CA_CODE = TIS.C_S_CODE                                                           WHERE C_PORT_CODE IN (SELECT * FROM TABLE(?))                                                             AND D_ASTSTAT = ?                                                             AND C_DAI_CODE = 'HBZJ'                                                             AND C_NAV_TYPE = 'CACH'                                                             AND ((C_DV_ACC_TYPE NOT LIKE '%EX_RES%' AND C_DV_ACC_TYPE NOT LIKE '%ACC_TD_BAIL%' AND                                                                 TRIM(C_CA_CODE) IS NOT NULL AND                                                                 TRIM(F.C_T_CODE) IS NOT NULL)                                                                  OR                                                                 ((C_DV_ACC_TYPE LIKE '%EX_RES%' OR C_DV_ACC_TYPE LIKE '%ACC_TD_BAIL%') AND                                                                 TRIM(TIS.C_T_CODE) IS NULL))) A                                                    FULL JOIN (SELECT SUM(0 + (CASE                                                                           WHEN C_DAI_CODE IN ('HBZJ', 'ZQQSK', 'ZQQSK_SQK') THEN N_PORT_MV *                                                                            N_WAY                                                                           ELSE                                                                            N_PORT_MV * N_WAY * -1                                                                         END)) AS N_PORT_MV,                                                                     SUM(0 + (CASE                                                                           WHEN C_DAI_CODE IN ('HBZJ', 'ZQQSK', 'ZQQSK_SQK') THEN                                                                            N_ORIG_MV * N_WAY                                                                           ELSE                                                                            N_ORIG_MV * N_WAY * -1                                                                         END)) AS N_ORIG_MV,                                                                     SUM(0 + (CASE                                                                           WHEN C_DAI_CODE IN ('HBZJ', 'ZQQSK', 'ZQQSK_SQK') THEN                                                                            N_PORT_COST * N_WAY                                                                           ELSE                                                                            N_PORT_COST * N_WAY * -1                                                                         END)) AS N_PORT_COST,                                                                     C_PORT_CODE,                                                                     C_DC_CODE,                                                                     D_ASTSTAT                                                                FROM (SELECT A.C_PORT_CODE,                                                                             A.D_ASTSTAT,                                                                             A.N_WAY,                                                                             A.C_DAI_CODE,                                                                             A.N_PORT_MV,                                                                             A.N_ORIG_MV,                                                                             A.N_PORT_COST,                                                                             CASE                                                                               WHEN C_DV_ACC_TYPE LIKE                                                                                    '%EX_RES%' OR                                                                                    C_DV_ACC_TYPE LIKE                                                                                    '%ACC_TD_BAIL%' THEN                                                                                A.C_DC_CODE ||                                                                                '_INC'                                                                               ELSE                                                                                F.C_T_CODE                                                                             END AS C_DC_CODE                                                                        FROM T_R_FR_ASTSTAT A                                                                        LEFT JOIN INCZHZD F                                                                          ON A.C_CA_CODE =                                                                             F.C_S_CODE                                                                        LEFT JOIN TISZHZD TIS ON A.C_CA_CODE = TIS.C_S_CODE                                                                       WHERE C_PORT_CODE IN (SELECT * FROM TABLE(?))                                                                         AND D_ASTSTAT = ?                                                                         AND C_DAI_CODE IN ('HBZJ', 'ZQQSK', 'ZQQSK_SQK', 'YFK_SHK', 'YFK_SHF')                                                                         AND ((C_DV_ACC_TYPE NOT LIKE '%EX_RES%' AND                                                                             C_DV_ACC_TYPE NOT LIKE '%ACC_TD_BAIL%' AND                                                                             TRIM(F.C_T_CODE) IS NOT NULL) OR                                                                             ((C_DV_ACC_TYPE LIKE '%EX_RES%' OR                                                                             C_DV_ACC_TYPE LIKE '%ACC_TD_BAIL%') AND                                                                             TRIM(TIS.C_T_CODE) IS NULL)))                                                               GROUP BY C_PORT_CODE,                                                                        C_DC_CODE,                                                                        D_ASTSTAT) B                                                      ON A.C_PORT_CODE =                                                         B.C_PORT_CODE                                                     AND A.C_DC_CODE = B.C_DC_CODE                                                    FULL JOIN (SELECT A.C_PORT_CODE,                                                                     A.C_DC_CODE,                                                                     A.D_ASTSTAT,                                                                     SUM(N_ORIG_MV * N_WAY) AS N_ORIG_MV,                                                                     SUM(N_PORT_MV * N_WAY) AS N_PORT_MV                                                                FROM (SELECT A.C_PORT_CODE,                                                                             A.D_ASTSTAT,                                                                             A.N_WAY,                                                                             A.C_DAI_CODE,                                                                             A.N_PORT_MV,                                                                             A.N_ORIG_MV,                                                                             A.N_PORT_COST,                                                                             CASE                                                                               WHEN C_DV_ACC_TYPE LIKE '%EX_RES%' OR C_DV_ACC_TYPE LIKE '%ACC_TD_BAIL%' THEN                                                                                A.C_DC_CODE || '_INC'                                                                               ELSE                                                                                F.C_T_CODE                                                                             END AS C_DC_CODE                                                                        FROM T_R_FR_ASTSTAT A                                                                        LEFT JOIN INCZHZD F ON A.C_CA_CODE = F.C_S_CODE                                                                        LEFT JOIN TISZHZD TIS  ON A.C_CA_CODE = TIS.C_S_CODE                                                                       WHERE A.C_PORT_CODE IN (SELECT * FROM TABLE(?))                                                                         AND A.D_ASTSTAT = ?                                                                         AND A.C_DAI_CODE = 'YSLX_ZJ'                                                                         AND ((C_DV_ACC_TYPE NOT LIKE '%EX_RES%' AND                                                                                C_DV_ACC_TYPE NOT LIKE '%ACC_TD_BAIL%' AND                                                                               TRIM(F.C_T_CODE) IS NOT NULL)                                                                              OR                                                                             ((C_DV_ACC_TYPE LIKE '%EX_RES%' OR C_DV_ACC_TYPE LIKE '%ACC_TD_BAIL%') AND                                                                             TRIM(TIS.C_T_CODE) IS NULL))) A                                                               GROUP BY C_PORT_CODE,                                                                        C_DC_CODE,                                                                        D_ASTSTAT) C                                                      ON A.C_PORT_CODE =                                                         C.C_PORT_CODE                                                     AND A.C_DC_CODE = C.C_DC_CODE                                                    FULL JOIN (SELECT TA.C_PORT_CODE,                                                                     TA.C_DC_CODE,                                                                     SUM(ROUND(TA.N_SELL_MONEY * NVL(TO_NUMBER(PKG_FUN_F_EXPRESS.F_EXPRESS(TA.C_RATE_EXPR)), 1), 2)) AS N_SELL_MONEY,                                                                     SUM(TA.N_SELL_MONEY) AS N_ORIG_MONEY                                                                FROM (SELECT TA.C_PORT_CODE,                                                                             TA.N_SELL_MONEY,                                                                             PR.C_RATE_EXPR,                                                                             NVL(F.C_T_CODE, TA.C_DC_CODE) AS C_DC_CODE                                                                        FROM T_D_AC_SELL_TA TA                                                                        LEFT JOIN INCZHZD F ON TA.C_CA_CODE_SETT = F.C_S_CODE                                                                        LEFT JOIN T_D_AI_VAL_PR PR                                                                          ON TA.C_PORT_CODE = PR.C_PORT_CODE                                                                         AND D_VAL_ACCT = ?                                                                         AND C_PR_TYPE = 'R'                                                                         AND NVL(TA.C_DC_CODE, 'CNY') = PR.C_VAL_PR_CODE                                                                        LEFT JOIN T_P_AB_PORT PORT                                                                          ON TA.C_PORT_CODE = PORT.C_PORT_CODE                                                                       WHERE TA.C_PORT_CODE IN (SELECT * FROM TABLE(?))                                                                         AND C_DS_CODE = 'TAXS_SG'                                                                         AND D_SETT = PKG_FUN_GETDAY_HDAY.GETDAY_HDAY(PORT.C_HDAY_CODE, ?, 1, 'W')                                                                         AND D_CONFIRM != D_SETT                                                                         AND TRIM(F.C_T_CODE) IS NOT NULL) TA                                                               GROUP BY TA.C_PORT_CODE,                                                                        TA.C_DC_CODE) D                                                      ON A.C_PORT_CODE = D.C_PORT_CODE                                                     AND A.C_DC_CODE = D.C_DC_CODE)                                           ORDER BY C_PORT_CODE, ZQID)                                  UNION ALL                                  SELECT *                                    FROM (SELECT DISTINCT 3 AS SX,                                                          ZMDM,                                                          ZQID,                                                          TZFX,                                                          BWBSZ,                                                          RQ,                                                          LXYB,                                                          LXBWB,                                                          SL,                                                          TISMA,                                                          BWBCB,                                                          DWCB                                            FROM (SELECT R.C_PORT_CODE AS ZMDM,                                                         NVL(F.C_T_CODE,                                                             A.C_DC_CODE) AS ZQID,                                                         'L' AS TZFX,                                                         0 AS BWBSZ,                                                         ? AS RQ,                                                         0 AS LXYB,                                                         0 AS LXBWB,                                                         0 AS SL,                                                         NVL(D.C_T_CODE, A.C_DC_CODE) AS TISMA,                                                         0 AS BWBCB,                                                         0 AS DWCB                                                    FROM T_P_BI_CASH_ACC A                                                    JOIN T_P_AB_PORT_RELA R                                                      ON R.C_RELA_TYPE = 'RELA_CASH_ACC'                                                     AND R.N_CHECK_STATE = 1                                                     AND R.C_RELA_CODE = A.C_CA_CODE                                                    LEFT JOIN TISZHZD D ON A.C_CA_CODE = D.C_S_CODE                                                    JOIN INCZHZD F ON A.C_CA_CODE = F.C_S_CODE                                                   WHERE A.N_CHECK_STATE = 1                                                     AND R.C_PORT_CODE IN (SELECT * FROM TABLE(?))                                                     AND TRIM(F.C_T_CODE) IS NOT NULL                                                     AND C_DC_CODE NOT IN                                                         (SELECT DISTINCT C_DC_CODE                                                            FROM T_R_FR_ASTSTAT A                                                           WHERE A.C_PORT_CODE = R.C_PORT_CODE                                                             AND D_ASTSTAT = ?                                                             AND (TRIM(C_CA_CODE) IS NOT NULL OR                                                                 (C_DAI_CODE IN                                                                 ('HBZJ',                                                                    'ZQQSK',                                                                    'ZQQSK_SQK',                                                                    'YSK_SGK',                                                                    'YFK_SHK',                                                                    'YFK_SHF',                                                                    'YSLX_ZJ')))))                                           ORDER BY ZMDM, ZQID))                           ORDER BY ZMDM, ZQID)                                    UNION ALL                  SELECT *                    FROM (SELECT 3 AS SX,                                 NVL(A.C_PORT_CODE, C.C_PORT_CODE) AS ZMDM,                                 NVL(A.C_DC_CODE, C.C_DC_CODE) || '_INC' AS ZQID,                                 'L' AS TZFX,                                 NVL(N_PORT_MV, 0) + NVL(C.N_SELL_MONEY, 0) AS BWBSZ,                                 ? AS RQ,                                 0 AS LXYB,                                 0 AS LXBW,                                 NVL(N_ORIG_MV, 0) + NVL(C.N_ORIG_MONEY, 0) AS SL,                                 NVL(A.C_DC_CODE, C.C_DC_CODE) || '_INC' AS TISMA,                                 NVL(N_PORT_COST, 0) + NVL(C.N_SELL_MONEY, 0) AS BWBCB,                                 (NVL(N_ORIG_MV, 0) + NVL(C.N_ORIG_MONEY, 0)) /                                 NVL(NVL(N_PORT_MV, 0) + NVL(C.N_SELL_MONEY, 0), 1) DWCB                            FROM (SELECT A.C_PORT_CODE,                                         A.C_DC_CODE,                                         A.D_ASTSTAT,                                         SUM(N_ORIG_MV) AS N_ORIG_MV,                                         SUM(N_PORT_COST) AS N_PORT_COST,                                         SUM(N_PORT_MV) AS N_PORT_MV                                    FROM T_R_FR_ASTSTAT A                                   WHERE C_PORT_CODE IN (SELECT * FROM TABLE(?))                                     AND D_ASTSTAT = ?                                     AND C_NAV_TYPE NOT IN ('TOTAL', 'TOTAL_ALL', 'CHECK')                                     AND C_DAI_CODE NOT IN                                         ('ZQTZ_CB',                                          'MRFSJRZC',                                          'MCHGJRZC',                                          'YSGJ_CB',                                          'YSLX_ZQ',                                          'YFLX_ZQ',                                          'YSK_GL',                                          'HBZJ',                                          'YSLX_ZJ',                                          'ZQQSK',                                          'ZQQSK_SQK',                                          'YSK_SGK',                                          'YFK_SHK',                                          'YFK_SHF')                                   GROUP BY C_PORT_CODE, C_DC_CODE, D_ASTSTAT) A                            JOIN T_S_DC_CURY B                              ON A.C_DC_CODE = B.C_DC_CODE                            FULL JOIN (SELECT TA.C_PORT_CODE,                                             TA.C_DC_CODE,                                             SUM(ROUND(TA.N_SELL_MONEY *                                                       NVL(TO_NUMBER(PKG_FUN_F_EXPRESS.F_EXPRESS(PR.C_RATE_EXPR)),                                                           1),                                                       2)) AS N_SELL_MONEY,                                             SUM(TA.N_SELL_MONEY) AS N_ORIG_MONEY                                        FROM T_D_AC_SELL_TA TA                                        LEFT JOIN T_D_AI_VAL_PR PR                                          ON TA.C_PORT_CODE = PR.C_PORT_CODE                                         AND D_VAL_ACCT = ?                                         AND C_PR_TYPE = 'R'                                         AND NVL(TA.C_DC_CODE, 'CNY') = PR.C_VAL_PR_CODE                                        LEFT JOIN T_P_AB_PORT PORT ON TA.C_PORT_CODE = PORT.C_PORT_CODE                                       WHERE TA.C_PORT_CODE IN (SELECT * FROM TABLE(?))                                         AND C_DS_CODE = 'TAXS_SG'                                         AND D_CONFIRM < PKG_FUN_GETDAY_HDAY.GETDAY_HDAY(PORT.C_HDAY_CODE, ?, 1, 'W')                                         AND PKG_FUN_GETDAY_HDAY.GETDAY_HDAY(PORT.C_HDAY_CODE, ?, 1, 'W') < D_SETT                                       GROUP BY TA.C_PORT_CODE, TA.C_DC_CODE) C                              ON C.C_PORT_CODE = A.C_PORT_CODE                             AND C.C_DC_CODE = A.C_DC_CODE                           ORDER BY ZMDM, ZQID))    GROUP BY SX, ZMDM, ZQID, TZFX, RQ, TISMA) T    ORDER BY SX, ZMDM, ZQID ";
       // String str = "abcd?e?f?";
        char[] chars = str.toCharArray();
        List<Character> newchars = new ArrayList<>();
        int i = 0;
        for(char c:chars){
            if(c == '?'){
                i=i+1;
                newchars.add(' ');
                newchars.add(':');

                newchars.add((char) (i+'0'));
                newchars.add(' ');
            }else{
                newchars.add(c);
            }
        }
        for(char n:newchars){
            System.out.print(n);
        }
    }

}
